<header id='app-bar' class="mdc-top-app-bar" data-controller='search'>
  <% show_search_bar = params[:search].present? %>
  <div class="mdc-top-app-bar__row <%= show_search_bar ? 'd-none' : '' %>" data-search-target="appBar">
    <div class="flex flex-row justify-center items-center space-x-4 ms-4">
      <%= button_tag type: "button", class: "size-6 cursor-pointer", data: { action: "click->navigation-drawer#toggle" } do %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      <% end %>
      <%= link_to 'MiCarrera', root_path, class: 'home-button'%>
    </div>
    <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" role="toolbar">
      <button id="searchIcon" class="material-icons mdc-top-app-bar__action-item mdc-icon-button" data-action="search#toggle">search</button>
      <span hidden>
        <button id="butInstall" class="material-icons mdc-top-app-bar__action-item mdc-icon-button">cloud_download</button>
      </span>
      <%= yield :credits %>
      <div class="relative mx-3" data-controller='user-menu' data-action="click@document->user-menu#onClick">
        <%= button_tag type: "button", id: "user-menu", class: "flex cursor-pointer", data: { user_menu_target: 'trigger', action: 'click->user-menu#toggle:stop' } do %>
          <% if current_user %>
            <div class="flex items-center justify-center w-6 h-6 rounded-full bg-sky-500">
              <%= current_user.email.first.capitalize %>
            </div>
          <% else %>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" class="size-6">
              <path 
                fill-rule="evenodd" 
                d="M18.685 19.097A9.723 9.723 0 0 0 21.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 0 0 3.065 7.097A9.716 9.716 0 0 0 12 21.75a9.716 9.716 0 0 0 6.685-2.653Zm-12.54-1.285A7.486 7.486 0 0 1 12 15a7.486 7.486 0 0 1 5.855 2.812A8.224 8.224 0 0 1 12 20.25a8.224 8.224 0 0 1-5.855-2.438ZM15.75 9a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" 
                clip-rule="evenodd" 
              />
            </svg>
          <% end %>
        <% end %>
        <%= render 'shared/user_menu' %>
      </div>
    </section>
  </div>
  <div id="searchbar" class="mdc-top-app-bar__row <%= show_search_bar ? '' : 'd-none' %>" data-search-target="searchbar">
    <%= form_with(url: all_subjects_path, method: :get, local: true) do |f| %>
      <div class="mdc-text-field mdc-text-field--filled mdc-text-field--label-floating mdc-text-field--no-label mdc-text-field--with-trailing-icon">
        <span class="mdc-text-field__ripple"></span>
        <%= f.text_field :search, value: params[:search], class: "mdc-text-field__input", placeholder: "Buscar por nombre o cÃ³digo de la materia", autofocus: true, data: { 'search-target': "searchInput" } %>
        <i class="material-icons mdc-text-field__icon mdc-text-field__icon--trailing" data-action="click->search#toggle" tabindex="0" role="button">close</i>
        <span class="mdc-line-ripple"></span>
      </div>
    <% end %>
  </div>
</header>
