<div data-controller="bedel loading <%= "confetti" if @graduated %>" id="subjects" >
  <%= render "approvals/spinner_template" %>
  <%= turbo_frame_tag :subjects_page, @pagy.page, target: :_top do %>
    <% @subjects.group_by(&:category).each do |category, subjects| %>
      <div
        data-controller="list-separator"
        data-list-separator-target="separator"
        class="hidden separator items-center h-[50px] border-y border-t-gray-100 border-b-gray-200 bg-gray-50 px-3 py-1.5 text-sm/6 font-semibold text-gray-900"
      >
        <h3 class="grow list-separator-header">
          <%= formatted_category(category) %>
        </h3>
        <h3 class='w-[50px] text-center'>Curso</h3>
        <h3 class='w-[50px] text-center'>Examen</h3>
      </div>

      <ul role="list">
        <%= render subjects %>
      </ul>
    <% end %>

    <% if @pagy.next.present? %>
      <%= turbo_frame_tag :subjects_page, @pagy.next,
        data: {
          controller: "infinite-scroll",
        },
        src: subjects_path(page: @pagy.next),
        loading: :lazy,
        target: :_top do %>
        <div role="status" class="flex justify-center items-center m-2">
          <%= render "shared/spinner" %>
        </div>
      <% end %>
    <% end %>
  <% end %>
</div>
