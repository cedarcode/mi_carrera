<%= turbo_stream.replace "planned-credits" do %>
  <%= render "credits_counter", planned_subjects: @planned_subjects %>
<% end %>

<% if @reload_not_planned_subjects %>
  <% if @not_planned_approved_subjects_was_empty %>
    <%= turbo_stream.before "semester-1" do %>
      <%= render "subjects/not_planned_subjects_list", subjects: @not_planned_approved_subjects %>
    <% end %>
  <% else %>
    <%= turbo_stream.replace "not-planned-subjects", method: :morph do %>
      <%= render "subjects/not_planned_subjects_list", subjects: @not_planned_approved_subjects %>
    <% end %>
  <% end %>
<% end %>

<% @semesters_to_refresh.each do |semester| %>
  <% planned_subjects = @planned_subjects.select { |subject| subject.semester == semester } %>

  <%= turbo_stream.replace "semester-#{semester}-header", method: :morph do %>
    <%= render 'semester_header', semester: semester, planned_subjects: planned_subjects %>
  <% end %>

  <%= turbo_stream.replace "semester-#{semester}-subjects-list", method: :morph do %>
    <%= render 'semester_subjects_list', semester: semester, planned_subjects: planned_subjects %>
  <% end %>
<% end %>

<% (1..10).each do |semester| %>
  <%= turbo_stream.replace "semester-#{semester}-add-subject-form" do %>
    <%= render 'semester_add_subject_form', semester: semester, not_planned_subjects: @not_planned_subjects %>
  <% end %>
<% end %>
